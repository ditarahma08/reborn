import React, { useState } from 'react';
import {
  Carousel as CarouselComponent,
  CarouselCaption,
  CarouselControl,
  CarouselIndicators,
  CarouselItem,
} from '../src/index';

export default {
  title: 'Components/Carousel',
  component: CarouselComponent,
  argTypes: {
    cssModule: {
      table: {
        disable: true,
      },
    },
  },
};

export const Playground = (args) => {
  const { items } = args;
  const [activeIndex, setActiveIndex] = useState(0);
  const [animating, setAnimating] = useState(false);

  const next = () => {
    if (animating) return;
    const nextIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;
    setActiveIndex(nextIndex);
  };

  const previous = () => {
    if (animating) return;
    const nextIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;
    setActiveIndex(nextIndex);
  };

  const goToIndex = (newIndex) => {
    if (animating) return;
    setActiveIndex(newIndex);
  };

  const slides = items.map((item) => (
    <CarouselItem
      onExiting={() => setAnimating(true)}
      onExited={() => setAnimating(false)}
      key={item.src}
    >
      <img src={item.src} alt={item.altText} />
      <CarouselCaption
        captionText={item.subcaption}
        captionHeader={item.caption}
      />
    </CarouselItem>
  ));

  return (
    <div className="story-wrapper">
      <CarouselComponent
        {...args}
        activeIndex={activeIndex}
        next={next}
        previous={previous}
      >
        <CarouselIndicators
          items={items}
          activeIndex={activeIndex}
          onClickHandler={goToIndex}
        />
        {slides}
        <CarouselControl
          direction="prev"
          directionText="Previous"
          onClickHandler={previous}
        />
        <CarouselControl
          direction="next"
          directionText="Next"
          onClickHandler={next}
        />
      </CarouselComponent>
    </div>
  );
};

Playground.args = {
  onBoard: true,
  interval: false,
  items: [
    {
      src: 'https://png.pngtree.com/png-vector/20190726/ourlarge/pngtree-car-workshop-icon-design-vector-png-image_1608773.jpg',
      altText: 'Workshop Discovery',
      caption: 'Workshop Discovery',
      subcaption:
        'Temukan bengkel terdekat dari lokasi kamu atau dapatkan rekomendasi bengkel dari Otoklix',
    },
    {
      src: 'https://png.pngtree.com/png-clipart/20190916/ourlarge/pngtree-electronic-payment-bill-stereo-illustration-png-image_1730308.jpg',
      altText: 'Price Warranty',
      caption: 'Price Warranty',
      subcaption:
        'Dapatkan penawaran harga terbaik dari Otoklix secara transparan tanpa adanya biaya tersembunyi',
    },
    {
      src: 'https://png.pngtree.com/png-clipart/20190816/ourlarge/pngtree-cartoon-purple-ui-mobile-phone-online-office-illustration-png-image_1692789.jpg',
      altText: 'Semua Kebutuhan Mobilmu Tersedia di Sini',
      caption: 'Semua Kebutuhan Mobilmu Tersedia di Sini',
      subcaption:
        'Data mobil dan riwayat servis kamu tersimpan dalam satu aplikasi Otoklix',
    },
  ],
};
